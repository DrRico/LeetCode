### 1、cookie和session的区别

- **第一层楼**

什么是 Cookie 和 Session ?初级程序员高频面试题。

**什么是 Cookie**

HTTP Cookie（也叫 Web Cookie或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。Cookie 使基于无状态的 HTTP 协议记录稳定的状态信息成为了可能。

Cookie 主要用于以下三个方面：

- 会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）
- 个性化设置（如用户自定义设置、主题等）
- 浏览器行为跟踪（如跟踪分析用户行为等）

**什么是 Session**

Session 代表着服务器和客户端一次会话的过程。Session 对象存储特定用户会话所需的属性及配置信息。这样，当用户在应用程序的 Web 页之间跳转时，存储在 Session 对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。当客户端关闭会话，或者 Session 超时失效时会话结束。

- **第二层楼**

**Cookie 和 Session 有什么不同？**

- 作用范围不同，Cookie 保存在客户端（浏览器），Session 保存在服务器端。
- 存取方式的不同，Cookie 只能保存 ASCII，Session 可以存任意数据类型，一般情况下我们可以在 Session 中保持一些常用变量信息，比如说 UserId 等。
- 有效期不同，Cookie 可设置为长时间保持，比如我们经常使用的默认登录功能，Session 一般失效时间较短，客户端关闭或者 Session 超时都会失效。
- 隐私策略不同，Cookie 存储在客户端，比较容易遭到不法获取，早期有人将用户的登录名和密码存储在 Cookie 中导致信息被窃取；Session 存储在服务端，安全性相对 Cookie 要好一些。
- 存储大小不同， 单个 Cookie 保存的数据不能超过 4K，Session 可存储数据远高于 Cookie。

前两层楼内容，绝大部分同学都可以准确回答

- **第三层楼**

**为什么需要 Cookie 和 Session，他们有什么关联？**

说起来为什么需要 Cookie ，这就需要从浏览器开始说起，我们都知道浏览器是没有状态的(HTTP 协议无状态)，这意味着浏览器并不知道是张三还是李四在和服务端打交道。这个时候就需要有一个机制来告诉服务端，本次操作用户是否登录，是哪个用户在执行的操作，那这套机制的实现就需要 Cookie 和 Session 的配合。

那么 Cookie 和 Session 是如何配合的呢？我画了一张图大家可以先了解下。

![img](https://pic4.zhimg.com/80/v2-e651da81c8a95d8ddbdbc9e43cc8a082_1440w.jpg)

用户第一次请求服务器的时候，服务器根据用户提交的相关信息，创建创建对应的 Session ，请求返回时将此 Session 的唯一标识信息 SessionID 返回给浏览器，浏览器接收到服务器返回的 SessionID 信息后，会将此信息存入到 Cookie 中，同时 Cookie 记录此 SessionID 属于哪个域名。

当用户第二次访问服务器的时候，请求会自动判断此域名下是否存在 Cookie 信息，如果存在自动将 Cookie 信息也发送给服务端，服务端会从 Cookie 中获取 SessionID，再根据 SessionID 查找对应的 Session 信息，如果没有找到说明用户没有登录或者登录失效，如果找到 Session 证明用户已经登录可执行后面操作。

根据以上流程可知，SessionID 是连接 Cookie 和 Session 的一道桥梁，大部分系统也是根据此原理来验证用户登录状态。

三层楼的内容，大部分同学可以讲清楚。

- **第四层楼**

既然服务端是根据 Cookie 中的信息判断用户是否登录，那么**如果浏览器中禁止了 Cookie**，如何保障整个机制的正常运转。

**第一种方案**，每次请求中都携带一个 SessionID 的参数，也可以 Post 的方式提交，也可以在请求的地址后面拼接 xxx?SessionID=123456...。

**第二种方案**，Token 机制。Token 机制多用于 App 客户端和服务器交互的模式，也可以用于 Web 端做用户状态管理。

Token 的意思是“令牌”，是服务端生成的一串字符串，作为客户端进行请求的一个标识。Token 机制和 Cookie 和 Session 的使用机制比较类似。

当用户第一次登录后，服务器根据提交的用户信息生成一个 Token，响应时将 Token 返回给客户端，以后客户端只需带上这个 Token 前来请求数据即可，无需再次登录验证。

四层楼的内容，一部分同学可以讲清楚。

- **第五层楼**

**如何考虑分布式 Session 问题？**

在互联网公司为了可以支撑更大的流量，后端往往需要多台服务器共同来支撑前端用户请求，那如果用户在 A 服务器登录了，第二次请求跑到服务 B 就会出现登录失效问题。

分布式 Session 一般会有以下几种解决方案：

- Nginx ip_hash 策略，服务端使用 Nginx 代理，每个请求按访问 IP 的 hash 分配，这样来自同一 IP 固定访问一个后台服务器，避免了在服务器 A 创建 Session，第二次分发到服务器 B 的现象。
- Session 复制，任何一个服务器上的 Session 发生改变（增删改），该节点会把这个 Session 的所有内容序列化，然后广播给所有其它节点。
- 共享 Session，服务端无状态话，将用户的 Session 等信息使用缓存中间件来统一管理，保障分发到每一个服务器的响应结果都一致。

建议采用第三种方案。

### 2、get和post的联系和区别

==**联系**==

- 1：get和post只是http请求的两种方式，底层都是TCP/IP协议进行通信的。大致过程：用户发出http请求（此时用户的电脑也是一个端，有自己的ip，通过socket使用tcp协议传送数据），请求数据包会通过tcp协议通过网络传给解析的ip，ip收到数据之后（可能还会使用tcp协议与其他ip进行数据交互），处理完成之后，再通过tcp协议将结果返回给用户。所以get和post本质并无区别，只是被http规定了不同的行为和方式。
- 2：之所以有get和post区分，是因为他们底层数据的传输都是基于tcp协议，如果不做区分，网络中都是某一种服务类别，难免会混乱。为了避免这种情况发生，http协议诞生了。HTTP给网络运输设定了好几个服务类别，有GET, POST, PUT, DELETE等等，HTTP规定，当执行GET请求的时候，要给请求包贴上GET的标签（设置method为GET），而且要求把传送的数据放在url中以方便记录。如果是POST请求，在请求数据包贴上POST的标签。

==**区别**==

- 1：get在浏览器后退时无害，不发送请求。post在浏览器后退时会再次发送请求。
- 2：get参数通常放在url后面传递，post则通常放在Request body中传递。但实际上，get也可以用body少量传值，post也可以在url中少量传值，这在技术上是完全行的通的，只是不符合http的规定。所以get比post更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。
- 3：由于**URL 只支持ASCII 码**，因此GET 的参数中如果存在中文等字符就需要先进行编码。例如中文会转换为%E4%B8%AD%E6%96%87 ，而空格会转换为%20 。POST 参数支持标准字符集。
- 4：get在url中传输参数**有长度限制**，**post没有限制**。get之所以会限制请求长度，是因为url请求数据量太大对浏览器和服务器都是很大的负担，处理起来有成本，所以浏览器和服务器对单次访问都做了限制。（大多数）浏览器通常都会限制**url长度在2K个字节**，而（大多数）服务器最多处理64K大小的url。超过的部分，恕不处理。虽然GET可以带request body，也不能保证一定能被接收到。所以此处的不同，是因为HTTP的规定和浏览器/服务器的限制，导致他们在应用过程中体现出一些不同。所以如果请求参数可能很长很多的话，直接用post即可（如果用get，超过限制，参数传不过去，会报null）！
- **5：==GET产生一个TCP数据包；POST产生两个TCP数据包（重点区别！）==**。对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）；而对于POST，浏览器先发送header，服务器响应**100 continue**，浏览器再发送data，服务器响应200 ok（返回数据）。也就是post请求，第一次将header发送过去，确认服务器和网络没问题可以服务，才会将真正的data数据提交。 因为POST需要两步，时间上消耗的要多一点，看起来GET比POST更有效。因此Yahoo团队有推荐用GET替换POST来优化网站性能。但这是一个坑！跳入需谨慎。为什么？
  -  5.1. GET与POST都有自己的语义，不能随便混用。**get从指定的资源获取数据，post是向指定的资源提交数据（使用场景！）**
  - 5.2.：在网络环境好的情况下，发一次包的时间和发两次包的时间差别基本可以无视。而在网络环境差的情况下，两次包的TCP在验证数据包完整性上，有非常大的优点。也就是网络好的话get和post请求效率基本一样，网络不好的时候post对验证请求数据完整性更有优势。
  - 5.3：并不是所有浏览器都会在POST中发送两次包，Firefox就只发送一次

**==用法==**

- 1：get：如果**主要是为了获取数据**，比如一些获取数据的get请求，且加上请求参数的url不会特别大（小于1k还是2k），且最好没有需要保密的字段，则用get请求；

- 2：post：如果**主要是为了提交一些数据**，比如提交一些数据给后台保存，删除等（通常是一些写方法），无论是否有一定数据量均可使用post；

- 3：以上没有严格划分，即使使用post提交请求来get一些数据也是可以的

### 3、IOS七层网络协议以及各层都有哪些协议

1、物理层协议有：EIA/TIA-232，du EIA/TIA-499，V.35， V.24，RJ45， Ethernet， 802.3 

2、数据链路zhi层协议有：Frame Relay，HDLC，PPP， IEEE 802.3/802.2

3、网络层dao协议有：IP，IPX，AppleTalk DDP 

4、传输层协议有：TCP，UDP，SPX

5、会话层协议有：RPC，SQL，NFS，NetBIOS，names，AppleTalk

6、表示层协议有：TIFF，GIF，JPEG，PICT，ASCII，EBCDIC，encryption

7、应用层协议有：FTP，WWW，Telnet，NFS，SMTP，Gateway，SNMP

![](https://iknow-pic.cdn.bcebos.com/472309f790529822a5d75652daca7bcb0b46d4bf)



![](https://img2018.cnblogs.com/blog/988316/201812/988316-20181206162654765-1849346930.png)



### 4、三次握手与四次挥手

![](https://images2015.cnblogs.com/blog/1036857/201610/1036857-20161008185648160-191189690.png)

























